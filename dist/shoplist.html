<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>卷皮列表页</title>
    <link rel="stylesheet" href="../css/common.css">
    <link rel="stylesheet" href="../css/common_header.css">
    <link rel="stylesheet" href="../css/shoplist.css">
    <script src="../script/ajax.js"></script>
    <script src="../script/jquery.js"></script>
    <script src="../script/common.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="../script/jquery.cookie.js"></script>
</head>
<body>
<!--================================= 导航栏 ================================-->
    <div class="bao_one">
        <div class="header_two">
                 <ul>
                    <li><a href="http://localhost:8080/denglu.html">登录</a></li>
                    <li><a href="http://localhost:8080/zhuce.html">免费注册</a></li><li>|</li>
                    <li><a href="http://localhost:8080/shoplist.html">我的订单</a></li>
                    <li><a href="http://localhost:8080/shoplist.html">商家入驻</a></li><li>|</li>
<!-- 购物车还未添加=============================================== -->
                     <!-- <li class="header_two_gou"><img src="../img/bao.png"/><a href="#">购物车</a></li><li>|</li> -->
<!-- 购物车还未添加============================================================ -->
                     <li><a href="http://localhost:8080/shoplist.html">商家中心</a></li>
                     <li class="header_two_one"><a href="http://localhost:8080/shoplist.html">客户服务</a>
                        <ol class="header_two_two">
                            <li><a href="http://localhost:8080/shoplist.html">帮助中心</a></li>
                            <li><a href="http://localhost:8080/shoplist.html">联系客服</a></li>
                        </ol>
                    </li>
                 </ul>
        </div>
</div>
<!--================================= 导航栏 ================================-->

<!--===================================搜索框一行===================================== -->
<div class="wai_one">
    <div class="header_one">
            <div class="header_one_top">
                   <img src="../img/jianpi_03.gif"/>
                   <div class="header_one_top_left">
                            <p>&nbsp;用&nbsp;户&nbsp;中&nbsp;心</p>
                            <p>JUANPI.COM</p>
                   </div>
           <!-- 后期加入百度搜索效果================================= -->
                   <div class="header_one_top_input">
                        <input type="text" placeholder="请输入您要搜索的商品">
                        <img src="../img/sou.png"/>
                 </div>
          <!-- 后期加入百度搜索效果================================== -->
                   <ul class="header_one_top_right">
                          <li><img src="../img/biao.jpg"/><span>10:00开枪</span></li><li>|</li>
                          <li><img src="../img/shandian.jpg"/><span>买手砍价</span></li><li>|</li>
                          <li><img src="../img/fangdajing.jpg"/><span>验货质检</span></li>
                   </ul>                   
            </div>
    </div>
</div>
<!--===================================搜索框一行===================================== -->

<!-- ============================================导航栏2 ====================================-->
<div class="nav">
        <ul class="nav_ul">
            <li ><a href="http://localhost:8080/index.html">首页</a></li>
            <li class="nav_list"><a href="#">品牌折扣</a></li>
            <li><a href="#">9.9包邮</a></li>
            <li><a href="#">即将上线</a></li>
            <li><img src="../img/shou.png"/><a href="#">手机版</a></li>
        </ul>
</div>
<span class="cut"></span>
<!-- ============================================导航栏2 ====================================-->

<!-- ===========================================logo图 =========================-->
<div class="bobdog">
    <img src="../img/bobdog.png"/>
    <ul>
        <li><h2>bobdoghouse旗舰店</h2></li>
        <li>店铺发货</li>
    </ul>
    <span class="bobdog_span"><img src="../img/shoucangxin.png"/><h3>收藏店铺</h3></span>
</div>
<!-- ===========================================logo图 =========================-->

<!-- ===================================热卖专场 ===============================-->
     <div class="bobdgo_buy">
           <h2>bobdoghouse巴布豆时尚热卖专场</h2>
           <div class="bobdgo_connect">
                <ul class="bobdgo_ul">
                    <li class="bobdgo_connect_mo"><a href="#">默认</a></li>
                    <li><a href="#">价格：</a></li>
                    <li><a href="#">销量</a></li>
                    <li><input type="checkbox"><a href="#">仅看有货</a></li>
                </ul>
                <div class="bobdgo_connect_timer">
                        <span>剩余</span>
                        <span id="hour">00</span>
                        <span>小时</span>
                        <span id="minute">00</span>
                        <span>分钟</span>
                        <span id="second">00</span>  
                        <span>秒</span>  
                </div>
           </div>
     </div>
     <!-- js特效 ==================-->
     <script>      
         $(function(){
             var oLi = $(".bobdgo_ul li")
             var nav = $(".nav_ul li")
             for(let i = 0 ; i < nav.length ; i++){
                    //   console.log(i)
                    nav.eq(i).click(function(){
                        //    console.log(i);
                        nav.eq(i).find("a").css({
                                color:"red"
                            })
                            .end()
                            .siblings().find("a")
                            .css({
                                color:"black"
                            })
                           
                        }.bind(this))
                  }
            //  console.log(oLi)
             //================================历史遗留问题
                  for(let i = 0 ; i < oLi.length ; i++){
                    //   console.log(i)
                       oLi.eq(i).click(function(){
                        //    console.log(i);
                           oLi.eq(i).find("a").css({
                                color:"red"
                            })
                            .end()
                            .siblings().find("a")
                            .css({
                                color:"black"
                            })
                           
                        }.bind(this))
                  }
             //================================历史遗留问题 
        	function foo(){
                var end = new Date("2018/10/27") ;
				//获取截止时间到现在的时间的毫秒数
				var now = new Date()
				var endMs = end.getTime();
				var nowMs = now.getTime();
				//获取差值
				var reduceMs = endMs - nowMs
				var nHour = parseInt(reduceMs/1000/60/60);
				var nMinute = parseInt((reduceMs - nHour * 1000 * 3600) / 1000 / 60);
				var nSecond = parseInt((reduceMs-nHour * 1000 * 3600-nMinute*1000*60)/1000);
				//赋值
				if(nHour <10){
					nHour = "0" + nHour
				}
				if(nMinute < 10){
					nMinute = "0" + nMinute
				}                                                                              
				if(nSecond < 10){
					nSecond = "0" + nSecond
				}  
				hour.innerHTML = nHour;
				minute.innerHTML= nMinute;
				second.innerHTML = nSecond;
			};
			foo();//防止刷新时,出现00:00:00的状况;
			setInterval(function(){
				foo()
			},1000)
 })
     </script>
<!-- ===================================热卖专场 ===============================-->
<div class="water">
     <ul class="flow_ul">
             <!-- 瀑布流渲染======================= -->
                   <!-- <li>
                                <dl>
                                    <dt class="flow_ul_img"><img src="${list[i].goods.imageUrl}" ></dt>
                                    <dd>
                                        <span class="falls_main_span">
                                        <p class="falls_main_p">
                                            <span>￥${list[i].goods.actualCurrentPrice}</span>
                                            <span>￥${list[i].goods.marketPrice}</span>
                                            </p>
                                            </span>
                                            <p class="falls_node">${list[i].goods.introduce}</p>
                                        </dd>
                                    </dl>
                                </li> -->
              <!-- 瀑布流渲染======================= -->
            
      </ul>
</div>

<div class="footer" id="footer">
        <p></p>
        <div class="footer_big">
        <!-- 上 -->
        <div class="foot_top">
                <div class="footer_big_left">
                <s>随时逛，及时抢</s>
                </div>
                <!-- 可重复 -->
                <div class="footer_big_center">
                <h2>获取更新</h2>
                <ul>
                        <li><a href = "#">iPhone/Android</a></li>
                        <li><a href = "#">卷皮QQ空间</a></li>
                        <li><a href = "#">卷皮新浪微博</a></li>
                        <li><a href = "#">开放API</a></li>
                </ul>
                </div>
                <div class="footer_big_center">
                        <h2>商务合作</h2>
                        <ul>
                        <li><a href = "#">卖家免费报名</a></li>
                        <li><a href = "#">商家入驻</a></li>
                        <li><a href = "#">廉政邮箱</a></li>
                        <li><a href = "#">开放平台</a></li>
                        </ul>
                </div>
                <div class="footer_big_center">
                        <h2>公司信息</h2>
                        <ul>
                        <li><a href = "#">关于卷皮</a></li>
                        <li><a href = "#">媒体报道</a></li>
                        </ul>
                </div>
                <div class="footer_big_center">
                        <h2>帮助中心</h2>
                        <ul>
                        <li><a href = "#">新手上路</a></li>
                        <li><a href = "#">网站地图</a></li>
                        </ul>
                </div>
                <!-- 可重复 -->
                <div class="footer_big_right">
                <s>周一至周日</s>
                <u>9:00-18:00</u>
                </div>
                <!-- 上 -->               
        </div>    
        <!-- 中 -->
        <div class="footer_center">
                <div class="foot_center_left">
                        <s>友情链接  :</s>
                </div>
                <div class="foot_center_center">
                        <a href="#">九块邮</a>
                        <a href="#">易登网</a>
                        <a href="#">普洱茶</a>
                        <a href="#">中国鲜花礼品网</a>
                        <a href="#">品牌鞋</a>
                </div>
                <div class="foot_right">
                        <span>更多&lt;&lt;</span>
                </div> 
        </div>
        <!-- 中 --> 
        <!-- 下       -->
        <div class="footer_bottom">
        <p>武汉奇米网科技有限公司鄂ICP备10209250号 | ICP许可证号 ： 鄂B2-20150109 | 鄂公网安备42018502000390号 | 食品流通许可证 SP4201991510041888</p>
        <p>Copyright © 2010 -2018 JuanPi.com All Rights Reserved</p>
        <ul>
                <li><img src="../img/r_315new.gif" /></li>
                <li><img src="../img/r_cnnic.gif" /></li>
                <li><img src="../img/r_gongshang.gif" /></li>
                <li><img src="../img/sm_124x47.png" /></li>    
        </ul>
        </div>
        <!-- 下       -->
        </div>
</div>
<!-- ====================吸顶菜单 =================-->
<div class="mount">
      
                <div class="connect">
                     <ul class="ul">
                         <li class="connect_mo"><a href="#">默认</a></li>
                         <li><a href="#">价格：</a></li>
                         <li><a href="#">销量</a></li>
                         <li><input type="checkbox"><a href="#">仅看有货</a></li>
                     </ul>
                     <div class="connect_timer">
                             <span>剩余</span>
                             <span id="hour_one">00</span>
                             <span>小时</span>
                             <span id="minute_one">00</span>
                             <span>分钟</span>
                             <span id="second_one">00</span>  
                             <span>秒</span>  
                     </div>
                </div>  
  </div>
  <!-- ====================吸顶菜单 =================-->
  <!--============ 左侧=========== -->
  <div class="back">
        <div class="back_head">
                <img src="../img/zuo_tou.png" />
                <div class="back_head_show">
                           <img src="../img/show.jpg"/>
<!-- 登录链接===================================================================== -->
                           <span>快来<a href="http://localhost:8080/denglu.html">登录</a>吧！么么哒</span>
                </div>
        </div>   
        <div class="back_buy">
                <img src="../img/zuo_gou.png"/>
                <p>购</p>
                <p>物</p>
                <p>袋</p>  
        </div>
        <div class="back_collect">
                <img src="../img/zuo_xin.png" />
                <div class="back_collect_show">
                        <p>我的收藏</p>
                </div>
        </div>
        <div class="back_quan">
                   <img src="../img/zuo_quan.png" />
                   <div class="back_quan_show">
                           <p>我的优惠券</p>
                   </div>
        </div>
       <div class="back_yijian">
                   <img src="../img/zuo_yijian.png" />
                   <div class="back_yijian_show">
                           <p>意见反馈</p>
                   </div>
       </div>
       <div class="back_Code">
                   <img src="../img/zuo_ma.png" />
                   <div class="back_Code_show">
                           <img src="../img/erweima_03.jpg">
                           <p>随时逛，及时抢</p>
                   </div>
      </div>
      <div class="back_top">
           <img src="../img/zuo_huiding.png" />
           <div class="back_top_show">
                   <p>回到顶部</p>
           </div>
      </div>
</div>
  <!--============ 左侧=========== -->
</body>
</html>
<script>
    // =============================瀑布流=================
        function WaterFull(){};
            WaterFull.prototype.init = function(){
                this.ul = document.querySelector(".flow_ul");
                //获取li即事件源
                this.btn = this.ul.children;
                console.log(this.btn);
                
                this.loadJson()
                .then(function(data){
                     console.log(this.json)
                    this.renderPage();
                    this.handleEvent();
                }.bind(this));  
            }
            WaterFull.prototype.handleEvent = function(){
                for (let i = 0; i < this.btn.length; i++) {
//            		console.log(i);
              		this.btn[i].onclick = function(){
              			console.log(i);
              			  setCookie(this.ary[i].id);
                          setCookie(this.ary[i].img);
                          setCookie(this.ary[i].title);
                          setCookie(this.ary[i].price);
                          setCookie(this.ary[i].old_price); 
//	               		console.log(getCookie("id"));
						location.href = "http://localhost:8080/detaile.html";
              		}.bind(this)		
	              }
            }
            
            WaterFull.prototype.loadJson = function(){
                return new Promise(function(success){
                    var xhr = new XMLHttpRequest();
                    xhr.open("GET","data.json");
                    xhr.send(null);
                    xhr.onload = function(){
                        if(xhr.status){
                            this.json = JSON.parse(xhr.response);
                            success(xhr.response);
                        }
                    }.bind(this);
                }.bind(this));
            }
            WaterFull.prototype.renderPage = function(){
                var html = "";
                var list = this.json.body.goodsList;
                this.ary = [];
                for(var i = 0 ; i < list.length; i++){
                    html += `<li>
                                <dl>
                                    <dt class="flow_ul_img" id="img"><a href="#"><img src="${list[i].goods.imageUrl}" ></a></dt>
                                    <dd>
                                        <span class="falls_main_span">
                                        <p class="falls_main_p">
                                            <span id="money">￥${list[i].goods.actualCurrentPrice}</span>
                                            <span id="old_money">￥${list[i].goods.marketPrice}</span>
                                            </p>
                                            </span>
                                            <p class="falls_node" id="shop_name">${list[i].goods.introduce}</p>
                                        </dd>
                                    </dl>
                                </li>`;
                                var duixiang = {
                                    id:"id="+list[i].goodsId,
                                    img : "img="+list[i].goods.imageUrl,
                                    price : "price="+list[i].goods.actualCurrentPrice,
                                    old_price : "old_price="+list[i].goods.marketPrice,
                                    title :"title="+list[i].goods.introduce
                                }
                                // var cookie;
                                // if(!(cookie = $.cookie("shoplist")) || cookie == "[]"){
                                //     // 建立结构;
                                //     $.cookie("shoplist",`[{"id":${list[i].goodsId},"num":1}]`);
                                //     // this.showNum();
                                //     return 0;
                                // }
                                // console.log(cookie)
                                 this.ary.push(duixiang);
                               console.log(this.ary)
                }
                this.ul.innerHTML += html;
                this.rendering = false;
            }
            var waterFull = new WaterFull();
            waterFull.init();

        // =====================瀑布流======================= -->
        // ====================吸顶菜单=====================
        var flag = false ;
        $(window).scroll(function(){
            var scrollTop = $("html,body").scrollTop();
            if(scrollTop >=500){
                if(flag) {return 0};
                flag = true ;
                $(".mount").stop().animate({
                    top:0
                },function(){
                    flag = false
                })
            }else{
                $(".mount").stop(true,true);
                $(".mount").css({
                    top : -55
                })
            }		   
        })		    	
    //==========================吸顶菜单===================
    // =======================================================倒计时==========	
	function time(end,hour,minute,second){
			function foo(){
				//获取截止时间到现在的时间的毫秒数
				var now = new Date()
				var endMs = end.getTime();
				var nowMs = now.getTime();
				//获取差值
				var reduceMs = endMs - nowMs
				var nHour = parseInt(reduceMs/1000/60/60);
				var nMinute = parseInt((reduceMs - nHour * 1000 * 3600) / 1000 / 60);
				var nSecond = parseInt((reduceMs-nHour * 1000 * 3600-nMinute*1000*60)/1000);
				//赋值
				if(nHour <10){
					nHour = "0" + nHour
				}
				if(nMinute < 10){
					nMinute = "0" + nMinute
				}                                                                              
				if(nSecond < 10){
					nSecond = "0" + nSecond
				}  
				hour.innerHTML = nHour;
				minute.innerHTML= nMinute;
				second.innerHTML = nSecond;
			}
			foo()//防止刷新时,出现00:00:00的状况
			setInterval(function(){
				foo()
			},1000)
		}
		var end_one = new Date("2018/10/27");
           time(end_one,hour_one,minute_one,second_one);
        
// ===========================================================倒计时==========
$(".back_head").mouseenter(function(){
		     $(".back_head_show").css({
				    display : "block"
			 })
	})
	$(".back_head").mouseleave(function(){
		$(".back_head_show").css({
			   display : "none"
		})  
   })
   //登录============
		$(".back_collect").mouseenter(function(){
			$(".back_collect_show").css({
				display : "block"
			})
		})
		$(".back_collect").mouseleave(function(){
			$(".back_collect_show").css({
				display : "none"
			})  
		})
//收藏=====================
	$(".back_quan").mouseenter(function(){
		$(".back_quan_show").css({
			display : "block"
		})
	})
	$(".back_quan").mouseleave(function(){
		$(".back_quan_show").css({
			display : "none"
		})  
	})
//优惠券======================
$(".back_yijian").mouseenter(function(){
	$(".back_yijian_show").css({
		display : "block"
	})
})
$(".back_yijian").mouseleave(function(){
	$(".back_yijian_show").css({
		display : "none"
	})  
})
//意见===================
$(".back_Code").mouseenter(function(){
	$(".back_Code_show").css({
		display : "block"
	})
})
$(".back_Code").mouseleave(function(){
	$(".back_Code_show").css({
		display : "none"
	})  
})
//二维码=======================
$(".back_top").mouseenter(function(){
	$(".back_top_show").css({
		display : "block"
	})
})
$(".back_top").mouseleave(function(){
	$(".back_top_show").css({
		display : "none"
	})  
})
$(window).scroll(function(){
	this.scrollTop = $("html,body").scrollTop();
		$(".back_top").click(function(){
		   document.documentElement.scrollTop  = 0;
		 // $("body,html").animate({ scrollTop:0},1000);
		})
})
//回到顶部====================
</script>